<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Music Playlist Organiser</title>

    <!-- jQuery for AJAX and DOM manipulation -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- Bootstrap for styling -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-4">
        <h1>Music Playlist Organiser</h1>

        <!-- Top control buttons -->
        <div class="mb-3" id="topButtons">
            <button id="showCreateButton" onclick="showCreate()" class="btn btn-primary mr-2">Create</button>
            <button onclick="showCreatePlaylist()" class="btn btn-success mr-2">Create Playlist</button>
            <button onclick="showPlaylists()" class="btn btn-info">Show Playlists</button>
        </div>

        <!-- Table displaying all tracks -->
        <div>
            <table class="table table-bordered" id="trackTable">
                <thead class="thead-light">
                    <tr>
                        <th>ID</th>
                        <th>Title</th>
                        <th>Artist</th>
                        <th>Genre</th>
                        <th>Play Count</th>
                        <th>Listeners</th>
                        <th>Update</th>
                        <th>Delete</th>
                        <th>Add</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <script>
        // Fetches all tracks from the backend and populates the table
        function getAll(){
            $.ajax({
                type: 'GET',
                url: '/api/tracks',  // API endpoint for fetching track data
                success: function(tracks){
                    var table = document.getElementById("trackTable").getElementsByTagName('tbody')[0];
                    
                    // Insert each track as a row in the table
                    for (var i = 0; i < tracks.length; i++){
                        var row = table.insertRow(-1);
                        row.insertCell(0).innerText = tracks[i].id;
                        row.insertCell(1).innerText = tracks[i].title;
                        row.insertCell(2).innerText = tracks[i].artist;
                        row.insertCell(3).innerText = tracks[i].genre;
                        row.insertCell(4).innerText = tracks[i].play_count;
                        row.insertCell(5).innerText = tracks[i].listeners;
                        row.insertCell(6).innerHTML =  '<button onclick="showUpdate(this)" class="btn btn-warning btn-sm">Update</button>';
                        row.insertCell(7).innerHTML =  '<button onclick="doDelete(this)" class="btn btn-danger btn-sm">Delete</button>';
                        row.insertCell(8).innerHTML =  '<button class="btn btn-secondary btn-sm">Add</button>';
                    }
                }
            });
        }

        // Run on page load
        getAll();
    </script>
</body>
</html>
